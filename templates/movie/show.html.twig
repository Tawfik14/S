{% extends 'base.html.twig' %}
{% block title %}{{ m.title }} — MovieNight{% endblock %}

{% block body %}
<article class="grid gap-8 lg:grid-cols-3">
  <div class="lg:col-span-2 space-y-4">
    <div class="aspect-[16/9] rounded-2xl overflow-hidden ring-1 ring-white/10 bg-neutral-900">
      {% if trailerKey %}
        <iframe
          class="w-full h-full"
          src="https://www.youtube.com/embed/{{ trailerKey }}"
          title="Trailer"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen></iframe>
      {% else %}
        <img src="{{ img.img(m.backdrop_path ?: m.poster_path, 'w780') }}" alt="{{ m.title }}" class="w-full h-full object-cover">
      {% endif %}
    </div>

    <div>
      <h1 class="text-3xl font-extrabold">{{ m.title }}</h1>
      {% if m.tagline %}<p class="mt-2 text-neutral-300">{{ m.tagline }}</p>{% endif %}
      <div class="mt-2 text-sm text-neutral-400">
        {% if m.release_date %}Sortie : {{ m.release_date|date('d/m/Y') }}{% endif %}
        {% if m.runtime %} • Durée : {{ m.runtime }} min{% endif %}
        {% if m.vote_average %} • Note TMDB : {{ m.vote_average|number_format(1, ',', ' ') }}/10{% endif %}
      </div>
      {% if m.genres %}
        <div class="mt-2 text-sm text-neutral-300">
          Genres : {{ m.genres|map(g => g.name)|join(', ') }}
        </div>
      {% endif %}
    </div>

    {% if m.overview %}
      <section class="mt-4">
        <h2 class="text-xl font-semibold">Synopsis</h2>
        <p class="mt-2 text-neutral-200 leading-relaxed">{{ m.overview }}</p>
      </section>
    {% endif %}
  </div>

  <aside class="lg:col-span-1">
    <div class="rounded-2xl bg-neutral-900 ring-1 ring-white/10 p-6">
      <h2 class="text-lg font-semibold">Acteurs principaux</h2>
      <ul class="mt-3 space-y-3">
        {% for c in cast %}
          {% set pslug = (c.name ?? 'personne')|slug %}
          <li>
            <a href="{{ path('app_person_show', { id: c.id, slug: pslug }) }}" class="flex items-center gap-3 group">
              <img src="{{ c.profile_path ? img.img(c.profile_path, 'w185') : asset('placeholder-avatar.png') }}" alt="{{ c.name }}" class="w-12 h-12 rounded-lg object-cover ring-1 ring-white/10 bg-neutral-800 group-hover:ring-rose-500/40 transition">
              <div>
                <div class="font-medium group-hover:text-rose-400 transition">{{ c.name }}</div>
                {% if c.character %}<div class="text-sm text-neutral-400">{{ c.character }}</div>{% endif %}
              </div>
            </a>
          </li>
        {% else %}
          <li class="text-neutral-400 text-sm">Casting indisponible.</li>
        {% endfor %}
      </ul>
    </div>
  </aside>
</article>
{% endblock %}

