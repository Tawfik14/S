{% extends 'base.html.twig' %}
{% block title %}Gérer Films & Séries — Administration{% endblock %}

{% block body %}
<section class="grid gap-8 lg:grid-cols-3">
  <div class="lg:col-span-1">
    <div class="rounded-2xl bg-neutral-900 ring-1 ring-white/10 p-6">
      <h2 class="text-xl font-semibold">Ajouter un film / une série</h2>

      {% for message in app.flashes('success') %}
        <div class="mt-4 rounded-lg bg-emerald-500/10 text-emerald-200 px-4 py-2 text-sm">{{ message }}</div>
      {% endfor %}

      <div class="mt-4">
        {{ form_start(form) }}
          <div class="space-y-4">
            {{ form_row(form.type,        {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
            {{ form_row(form.title,       {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
            {{ form_row(form.slug,        {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
            {{ form_row(form.tagline,     {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
            {{ form_row(form.synopsis,    {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
            {{ form_row(form.genresText,  {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
            <div class="grid grid-cols-2 gap-3">
              {{ form_row(form.runtime,   {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
              {{ form_row(form.rating,    {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
            </div>
            {{ form_row(form.posterUrl,   {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
            {{ form_row(form.backdropUrl, {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
            {{ form_row(form.trailerUrl,  {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
            {{ form_row(form.releaseDate, {'row_attr': {'class': 'space-y-1'}, 'attr': {'class': 'rounded-lg bg-neutral-800 border border-white/10 px-3 py-2'}}) }}
          </div>
          <div class="mt-6">
            {{ form_widget(form.save) }}
          </div>
        {{ form_end(form) }}
      </div>
    </div>
  </div>

  <div class="lg:col-span-2">
    <div class="rounded-2xl bg-neutral-900 ring-1 ring-white/10 p-6">
      <div class="flex items-center justify-between">
        <h2 class="text-xl font-semibold">Contenus ajoutés</h2>
        <span class="text-neutral-400 text-sm">{{ list|length }} éléments</span>
      </div>

      <div class="mt-4 grid gap-4 sm:grid-cols-2">
        {% for m in list %}
          <div class="group relative overflow-hidden rounded-xl bg-neutral-900 ring-1 ring-white/10">
            <div class="aspect-[16/9] overflow-hidden">
              <img src="{{ m.backdropUrl ?: m.posterUrl }}" alt="{{ m.title }}" class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-105">
            </div>
            <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3">
              <div class="flex items-center gap-2 text-xs text-neutral-300">
                <span class="px-2 py-0.5 rounded-full bg-white/10 ring-1 ring-white/10">{{ m.type == 'movie' ? 'Film' : 'Série' }}</span>
                {% if m.releaseDate %}<span class="text-neutral-400">• {{ m.releaseDate|date('Y') }}</span>{% endif %}
              </div>
              <div class="mt-1 font-semibold">{{ m.title }}</div>
              {% if m.genres %}<div class="text-xs text-neutral-400">{{ m.genres|join(', ') }}</div>{% endif %}
            </div>
          </div>
        {% else %}
          <div class="text-neutral-400">Aucune entrée pour le moment.</div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>
{% endblock %}
